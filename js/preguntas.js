var formElement=null,respuestaInput=null,respuestaInput2=null,respuestaSelect=null,respuestaSelect2=null,respuestasCheckbox=[],respuestasCheckbox2=[],respuestaRadio=null,respuestaRadio2=null,respuestasMultiple=[],respuestasMultiple2=[],nota=0,xmlDoc=null;function gestionarXml(e){var t=(xmlDoc=e.responseXML).getElementsByTagName("title")[0].innerHTML,n="tituloInput";ponerDatosText(t,n),respuestaInput=xmlDoc.getElementById("quest001").getElementsByTagName("answer")[0].innerHTML,ponerDatosText(t=xmlDoc.getElementsByTagName("title")[5].innerHTML,n="tituloInput2"),respuestaInput2=xmlDoc.getElementById("quest006").getElementsByTagName("answer")[0].innerHTML,n="tituloSelect";var l=0,o="/questions/question[@id='quest002']/option";ponerDatosSelect(t=xmlDoc.getElementsByTagName("title")[1].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),n,l),respuestaSelect=parseInt(xmlDoc.getElementsByTagName("answer")[2].innerHTML),n="tituloSelect2",l=2,o="/questions/question[@id='quest007']/option",ponerDatosSelect(t=xmlDoc.getElementsByTagName("title")[6].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),n,l),respuestaSelect2=parseInt(xmlDoc.getElementById("quest007").getElementsByTagName("answer")[0].innerHTML);var a="checkboxDiv";n="tituloCheckbox",o="/questions/question[@id='quest003']/option",ponerDatosCheckboxHtml(t=xmlDoc.getElementsByTagName("title")[2].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),a,n,"chckbx");var r=xmlDoc.getElementById("quest003").getElementsByTagName("answer").length;for(i=0;i<r;i++)respuestasCheckbox[i]=xmlDoc.getElementById("quest003").getElementsByTagName("answer")[i].innerHTML;for(a="checkboxDiv2",n="tituloCheckbox2",o="/questions/question[@id='quest008']/option",ponerDatosCheckboxHtml(t=xmlDoc.getElementsByTagName("title")[7].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),a,n,"chckbx2"),r=xmlDoc.getElementById("quest008").getElementsByTagName("answer").length,i=0;i<r;i++)respuestasCheckbox2[i]=xmlDoc.getElementById("quest008").getElementsByTagName("answer")[i].innerHTML;t=xmlDoc.getElementsByTagName("title")[3].innerHTML,a="radioDiv",n="tituloRadio",o="/questions/question[@id='quest004']/option";var u=xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null);for(ponerDatosRadio(t,u,a,n,"rd"),respuestaRadio=xmlDoc.getElementById("quest004").getElementsByTagName("answer")[0].innerHTML,a="radioDiv2",n="tituloRadio2",o="/questions/question[@id='quest009']/option",ponerDatosRadio(t=xmlDoc.getElementsByTagName("title")[8].innerHTML,u=xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),a,n,"rd2"),respuestaRadio2=xmlDoc.getElementById("quest009").getElementsByTagName("answer")[0].innerHTML,n="tituloMultiple",l=1,o="/questions/question[@id='quest005']/option",ponerDatosSelect(t=xmlDoc.getElementsByTagName("title")[4].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),n,l),r=xmlDoc.getElementById("quest005").getElementsByTagName("answer").length,i=0;i<r;i++)respuestasMultiple[i]=xmlDoc.getElementById("quest005").getElementsByTagName("answer")[i].innerHTML;n="tituloMultiple2",l=3;o="/questions/question[@id='quest010']/option";for(ponerDatosSelect(t=xmlDoc.getElementsByTagName("title")[9].innerHTML,xmlDoc.evaluate(o,xmlDoc,null,XPathResult.ANY_TYPE,null),n,l),r=xmlDoc.getElementById("quest010").getElementsByTagName("answer").length,i=0;i<r;i++)respuestasMultiple2[i]=xmlDoc.getElementById("quest010").getElementsByTagName("answer")[i].innerHTML}function corregirText(e,t,n){document.getElementById(e).value.toLowerCase()==t?(darRespuestaHtml(n+" pregunta: 1 punto"),nota+=1):darRespuestaHtml(n+" pregunta: 0 puntos")}function corregirSelect(e,t,n){document.getElementById(e).selectedIndex-1==t?(darRespuestaHtml(n+" pregunta: 1 punto"),nota+=1):darRespuestaHtml(n+" pregunta: 0 puntos")}function corregirCheckbox(e,t,n){var l=0,o=[],a=document.getElementById(e).getElementsByTagName("input");for(i=0;i<a.length;i++)if(a[i].checked){for(o[i]=!1,j=0;j<t.length;j++)i==t[j]&&(o[i]=!0);o[i]?(nota+=1/t.length,l+=1/t.length):nota-=1/t.length}darRespuestaHtml(1!=l?n+" pregunta: "+l+" puntos":n+" pregunta: "+l+" punto")}function corregirRadio(e,t,n){var l=0,o=document.getElementById(e).getElementsByTagName("input"),a=null;for(i=0;i<o.length;i++)o[i].checked&&(a=!1,i==t&&(a=!0),a&&(l+=1,nota+=1));darRespuestaHtml(1!=l?n+" pregunta: "+l+" puntos":n+" pregunta: "+l+" punto")}function corregirMultiple(e,t,n){for(var l=[],o=document.getElementById(e),a=0,i=0;i<o.options.length;i++)if(o.options[i].selected)for(var r=0;r<t.length;r++)o.options[i].value==t[r]&&l.push(o.options[i].value);l.length>0&&(a=l.length/t.length,nota+=a),darRespuestaHtml(1!=a&0!=a?n+" pregunta: "+a.toFixed(1)+" puntos":0==a?n+" pregunta: 0 puntos":n+" pregunta: 1 punto")}function ponerDatosText(e,t){document.getElementById(t).innerHTML=e}function ponerDatosSelect(e,t,n,l){document.getElementById(n).innerHTML=e;var o=document.getElementsByTagName("select")[l],a=t.iterateNext();for(i=0;a;){var r=document.createElement("option");r.text=a.innerHTML,r.value=i+1,i++,o.options.add(r),a=t.iterateNext()}}function ponerDatosCheckboxHtml(e,t,n,l,o){var a=document.getElementById(n);document.getElementById(l).innerHTML=e;var r=t.iterateNext();for(i=0;r;){var u=document.createElement("input"),s=document.createElement("label");s.innerHTML=r.innerHTML,s.setAttribute("for",o+i),u.type="checkbox",u.name=o,u.id=o+i,i++,a.appendChild(u),a.appendChild(s),a.appendChild(document.createElement("br")),r=t.iterateNext()}}function ponerDatosRadio(e,t,n,l,o){var a=document.getElementById(n);document.getElementById(l).innerHTML=e;var r=t.iterateNext();for(i=0;r;){var u=document.createElement("input"),s=document.createElement("label");s.innerHTML=r.innerHTML,s.setAttribute("for",o+i),u.type="radio",u.name=o,u.id=o+i,i++,a.appendChild(u),a.appendChild(s),a.appendChild(document.createElement("br")),r=t.iterateNext()}}function darRespuestaHtml(e){var t=document.createElement("p"),n=document.createTextNode(e);t.appendChild(n),document.getElementById("resultadosDiv").appendChild(t)}function darRespuestaTotal(e){document.getElementById("myform").style.display="none",document.getElementById("resultadoTotal").style.display="block";var t=document.createElement("p"),n=document.getElementById("respuestasDetalladas");t.id="total",n.id="respuestasDetalladas";var l=document.createTextNode(e),o=document.createTextNode("Para puntuación detallada, pulsa aquí:");t.appendChild(l),n.appendChild(o),document.getElementById("resultadoTotal").appendChild(t),document.getElementById("resultadoTotal").appendChild(n)}function tituloCorreccion(){darRespuestaHtml("Puntuación obtenida por pregunta:")}function presentarNota(){darRespuestaTotal("Puntuación total: "+nota.toFixed(2))}function inicializar(){document.getElementById("resultadosDiv").innerHTML="",nota=0}function comprobar(){var e=formElement,t=!1,n=!1,l=!1,o=!1;for(i=0;i<e.chckbx.length;i++)e.chckbx[i].checked&&(t=!0);for(i=0;i<e.chckbx2.length;i++)e.chckbx2[i].checked&&(n=!0);for(i=0;i<e.rd.length;i++)e.rd[i].checked&&(l=!0);for(i=0;i<e.rd2.length;i++)e.rd2[i].checked&&(o=!0);return""==document.getElementById("text").value?(document.getElementById("text").focus(),alert("La 1ª pregunta es obligatoria"),!1):0==e.elements[1].selectedIndex?(document.getElementById("sel").focus(),alert("Selecciona una de las opciones en la 2ª pregunta"),!1):t?l?-1==document.getElementById("selectMultiple").selectedIndex?(alert("Responde la 5ª pregunta"),document.getElementById("tituloMultiple").scrollIntoView(),!1):""==document.getElementById("text2").value?(document.getElementById("text2").focus(),alert("La 6ª pregunta es obligatoria"),!1):0==document.getElementById("sel2").selectedIndex?(document.getElementById("sel2").focus(),alert("Selecciona una de las opciones en la 7ª pregunta"),!1):n?o?-1!=document.getElementById("selectMultiple2").selectedIndex||(alert("Responde la 10ª pregunta"),document.getElementById("selectMultiple2").scrollIntoView(),!1):(document.getElementById("tituloRadio2").scrollIntoView(),alert("Selecciona una opción en la 9ª pregunta"),!1):(document.getElementById("tituloCheckbox2").scrollIntoView(),alert("Debes elegir una opción en la 8ª pregunta"),!1):(document.getElementById("tituloRadio").scrollIntoView(),alert("Selecciona una opción en la 4ª pregunta"),!1):(document.getElementById("tituloCheckbox").scrollIntoView(),alert("Debes elegir una opción en la 3ª pregunta"),!1)}window.onload=function(){(formElement=document.getElementById("myform")).onsubmit=function(){return inicializar(),comprobar()&&(tituloCorreccion(),corregirText("text",respuestaInput,"1ª"),corregirSelect("sel",respuestaSelect,"2ª"),corregirCheckbox("checkboxDiv",respuestasCheckbox,"3ª"),corregirRadio("radioDiv",respuestaRadio,"4ª"),corregirMultiple("selectMultiple",respuestasMultiple,"5ª"),corregirText("text2",respuestaInput2,"6ª"),corregirSelect("sel2",respuestaSelect2,"7ª"),corregirCheckbox("checkboxDiv2",respuestasCheckbox2,"8ª"),corregirRadio("radioDiv2",respuestaRadio2,"9ª"),corregirMultiple("selectMultiple2",respuestasMultiple2,"10ª"),presentarNota()),!1};var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&gestionarXml(this)},e.open("GET","xml/preguntas.xml",!0),e.send(),window.onmousedown=function(e){var t=e.target;if("option"==t.tagName.toLowerCase()&&t.parentNode.hasAttribute("multiple")){e.preventDefault(),t.hasAttribute("selected")?t.removeAttribute("selected"):t.setAttribute("selected","");var n=t.parentNode.cloneNode(!0);t.parentNode.parentNode.replaceChild(n,t.parentNode)}},document.getElementById("respuestasDetalladas").onclick=function(){document.getElementById("resultadoTotal").style.display="none",document.getElementById("resultadosDiv").style.display="block"}};
